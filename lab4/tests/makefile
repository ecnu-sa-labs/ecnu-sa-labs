# é…ç½®
PYTEST := pytest
PYTHON := python3

# æµ‹è¯•æ–‡ä»¶
TEST_FILES := test1.py test2.py test3.py test4.py
ALL_TESTS := $(TEST_FILES)

.PHONY: all test1 test2 test3 test4 clean

## è¿è¡Œæ‰€æœ‰æµ‹è¯•æ–‡ä»¶
all:
	@echo "ğŸš€ è¿è¡Œæ‰€æœ‰æµ‹è¯•æ–‡ä»¶..."
	@for test in $(TEST_FILES); do \
		echo "=============================================="; \
		echo "è¿è¡Œæµ‹è¯•: $$test"; \
		$(PYTEST) $$test -q --tb=no || true; \
		echo "=============================================="; \
	done
	@echo "âœ… æ‰€æœ‰æµ‹è¯•æ‰§è¡Œå®Œæˆ!"

## è¿è¡Œtest1.py (å±æ€§æµ‹è¯•)
test1:
	@echo "ğŸ”¬ è¿è¡Œå±æ€§æµ‹è¯• (test1.py)..."
	@$(PYTEST) test1.py -q --tb=no || true

## è¿è¡Œtest2.py (å˜å½¢æµ‹è¯•)
test2:
	@echo "ğŸ”„ è¿è¡Œå˜å½¢æµ‹è¯• (test2.py)..."
	@$(PYTEST) test2.py -q --tb=no || true

## è¿è¡Œtest3.py (å¤æ‚å˜å½¢æµ‹è¯•)
test3:
	@echo "ğŸ¯ è¿è¡Œå¤æ‚å˜å½¢æµ‹è¯• (test3.py)..."
	@$(PYTEST) test3.py -q --tb=no || true

# è¿è¡Œtest4.py (åŸºäºæ¨¡å‹æµ‹è¯•)
test4:
	@echo "ğŸ“Š è¿è¡ŒåŸºäºæ¨¡å‹æµ‹è¯• (test4.py)..."
	@$(PYTEST) test4.py -q --tb=no || true

## æ¸…ç†ç¼“å­˜æ–‡ä»¶
clean:
	@echo "ğŸ§¹ æ¸…ç†æµ‹è¯•ç¼“å­˜..."
	@find . -name "*.pyc" -delete
	@find . -name "__pycache__" -type d -exec rm -rf {} + 2>/dev/null || true
	@find . -name ".pytest_cache" -type d -exec rm -rf {} + 2>/dev/null || true
	@find . -name ".hypothesis" -type d -exec rm -rf {} + 2>/dev/null || true
	@rm -rf report
	@find ../bugs -name "*.pyc" -delete 2>/dev/null || true
	@find ../bugs -name "__pycache__" -type d -exec rm -rf {} + 2>/dev/null || true
	@find ../src -name "*.pyc" -delete 2>/dev/null || true
	@find ../src -name "__pycache__" -type d -exec rm -rf {} + 2>/dev/null || true
	@echo "âœ… æ¸…ç†å®Œæˆ"